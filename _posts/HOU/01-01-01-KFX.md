---
title: KFX

categories:
 - HOU
tags:
- Houdini
- Animation
- SOP
description: KineFX - Rigs, Retarget, Animation
permalink: /kfx/
---

[CFX](/cfx/)


[SOP_KineFX.hiplc](/src/hip/SOP_KineFx.hiplc)   
[Unreal Animation](/uanim/)    
[Principles of animation](/animation/)   


[Kine FX - docs](https://www.sidefx.com/docs/houdini/character/kinefx/index.html)    
[cgwiki](https://www.tokeru.com/cgwiki/index.php?title=HoudiniKinefx#Motion_clip_editing_via_motion_trails)    
[YT KineFX A Simple IK/FK](https://www.youtube.com/watch?v=zMcLms5a0lo)   
[KineFX Masterclass | Houdini Illume | Jeff Wagner](https://www.youtube.com/watch?v=Z04t_OxBshA)  
[Henry HIVE](https://www.youtube.com/watch?v=iME3rfsRFP0)      
[Houdini KineFX 101: Tutorial One - FBX Import, Rig Pose, Skeleton Blend](https://www.youtube.com/watch?v=7vg0bnc5R7Y)   

All working on world level on points. The parent-child relationship between joints in a hierarchy is determined by vertex order. However, point ordering is not considered when traversing the hierarchy.
Create skeleton. Rig is separated (like shadow rig) hierarchy to control rig > clean for export   



## Nomenclature
- **Control Geo** - (name on primitive)     
- **Joints** - points (name on points) Point is joint when has transform attribute and name attribute  
 - `@name` unique per point   
 - `@P`  (3flt)    - handle world space translation
 - `@transform` (9flt - matrix) - (matrix3) rotation, scale, ...? .
- **Hierarchy** - poly line - define hierarchy of joints









---

# Create skeleton

<img src="/src/kine/c1.png" width="350">     


## Create Skeleton from scratch
#### [Skeleton] SOP
Modify and Create ~skelet. Can control bone placement, rename bones, orient selected bones, a lot of shortcuts (`RMB` menu, `P` - details of joints).
- create @localtransform.  (with correct orientation)

Workflow:
create spine:
- from side view create 1 bone in center of gravity (COG)> to bottom of neck, (spine_end)
- select joint RMB > split  
 - child compensate on bar > fix pos
- select all RMB > orient selected joints
- select first (COG) > P > zero rotate value
- name
create leg
- from side view
- new chain MMB
- from hip  to foot
- from front view fix start and rotete
create head:
- enter to create mode
- from side view (no child compensate), connected to end spine
create hands:
create clavicle:
- as a point.
reparent to connect:
mirror:

#### [Reparent Joints] SOP
To create continous hierarchy.
select joint, and parent

#### [Skeleton Mirror] SOP

#### `delete joints`
 - with reparent  

## Create Skeleton From spline
Skeleton from Poly line: Any SOP polygonal line into a joint chain with the  Rig Doctor SOP node node (and later  with Skeleton SOP )


#### [Rig doctor] SOP
- create missing @name  
- debug hierarchy
- init Transforms
----------




#### [Orient along curve] SOP
- create transform (3x3 transform), and tangent metod to next edge  

#### [Re-Orient Joints] SOP

[sidefx.com/docs/houdini/character/kinefx/skeletons.html](https://www.sidefx.com/docs/houdini/character/kinefx/skeletons.html#creatingskels)




---

# Controls
Build the animation rig.

### IK
create controllers by deleting parts of skeleton

- fullbodyIK
- IkChain:
   - select  root mid and tip bones points
   - set! match by name

<img src="/src/kine/ik1.png" width="150">   

### Curve
<img src="/src/kine/curve.png" width="150">    




### Control geometry
`Control`(or any geo) +  prim name     
`AtachControlGeo` -

- `attach joint geo` (as 3op of pose tool) still technical approach. (next release for artists approach)


- motion trails (animation style) in SOP
---

# Capture (skin)
Skin geometry.


## Capture soft

<img src="/src/kine/skin.png" width="350">   


Capture workflow nodes:   
- `BoneCaptureLine` - define capture regions @joints    
- `Tetembed`, create mesh weightings  
- `BoneCaptureBiharmonic`, transfers weights to skin   

change pose and `Capturelayerpaint` to paint  after biharmonic (po region name wiec troche odporne )


## Capture rigid

`capturePackedGeo` - check pack input>unpack Output . manual capture: geo: * joint name of joint

---

# Motion
/ Animation


**[ Motion Clip ] SOP** - Convert to Motion Clip -  see all frames at once  (not time dependent)   Enable to operat on neighbour frames    
**[ Motion Clip Evaluate ] SOP** -  Convert to Animation -  time dependent Geometry caches One frame per frame.  

## Animation

#### Root motion
- **[ Extract Locomotion ] SOP** -  extract root motion   


#### Mix Anims
- **[ Skeleton Blend ] SOP** - feed with 2 animations
- **[ Time Shift ] SOP**

## Motion Clips
All rigs at once. Way of dealing with motion, so for most tools `motion clip evaluate`.
One for frame, packed primitive with pack attrribute `time`

- **[ Configure Clip Info ] SOP**  

- **[ Motion Clip Cycle ] SOP**  
- **[ Motion Clip Extract] SOP**  - Extract Frames

- **[ Motion Clip Blend] SOP**  - kitbash 2 files.
Can delete some bones and apply animation for a part

## Mocap
- `motion clip extract key poses` - optimize mocap

## Secondary motion
- secondary motion /

## Ragdoll

## Vellum



----

`rigpose`
`rigstashpose` - create rest pos 4x4Matrix Store a static pose on a skeleton as a matrix point attribute.




---
# Retarget

<img src="/src/kine/d1.png" width="350">    

Retarget   
- **[ Rig Match Pose ] SOP** -   lineup pose in viewport   
- **[ Map Points ] SOP** -    
- **[ Full body ik ] SOP** -      
`fktransfer` -  
`skeleton blend` - i.e. fullbodyik/fktransfer



---


# Rig Wrangle

`rotate(3@localtransform, @Time, {1,0,0});`


# Rig VOP

twoboneik
lookatconstraint
parentconstraint


### VOP:
`rigattribvop` - chops and more stuff

#### VOPS
`lookatkinefx` -  
`lookat constraint` -  


---

# Repair
`realistic shoulder` -        
`reverse foot` -   
`stabilize joints` -   select joints to stabilize,

---


# To Unreal

90+- ?  how to position anim and where is save to rotate ?????

control rig - manipulating bones transforms   
animation graf - blending , playback  

https://vimeo.com/rokandic


---

https://www.tokeru.com/cgwiki/index.php?title=HoudiniKinefx


-----------
crowd  
Agent from skeleton
